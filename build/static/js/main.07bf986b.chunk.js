(this["webpackJsonpmonday-integration-quickstart-app"]=this["webpackJsonpmonday-integration-quickstart-app"]||[]).push([[0],{113:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(5),c=n.n(o),s=(n(47),n(1)),u=n.n(s),i=n(2),p=n(8),l=n(9),f=n(12),d=n(11),m=(n(20),n(21),n(18)),x=n(6),h=n.n(x),y=n(41),v=n.n(y),b=(n(63),n(66),"https://test102-monday-pipl.herokuapp.com");function w(){return(w=Object(i.a)(u.a.mark((function e(t,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(b+"/api/monday/test",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({colData:{prefix:t,targetCol:n}})});case 2:return r=e.sent,e.next=5,r.json();case 5:return r=e.sent,e.abrupt("return",r.data);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(){return(j=Object(i.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(b+"/api/monday/addColumn",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t})});case 2:return n=e.sent,console.log("res: ",n),e.next=6,n.json();case 6:return n=e.sent,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return(g=Object(i.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(b+"/api/monday/auth",{method:"post",headers:{"Content-Type":"application/json"}});case 2:return t=e.sent,console.log("res: ",t),e.next=6,t.json();case 6:return t=e.sent,e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return(k=Object(i.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("domain: ",b),e.next=3,fetch(b+"/api/monday/getPrefixMap",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({boardId:t})});case 3:return n=e.sent,e.next=6,n.json();case 6:return n=e.sent,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return(O=Object(i.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("domain: ",b),e.next=3,fetch(b+"/api/monday/getPrefixMapAll",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({boardId:t})});case 3:return n=e.sent,e.next=6,n.json();case 6:return n=e.sent,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){return(C=Object(i.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(b+"/api/monday/updatePrefixMap",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({prefixMap:t})});case 2:return n=e.sent,e.next=5,n.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return(P=Object(i.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(b+"/api/monday/updatePrefixMapAll",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({prefixMapAll:t})});case 2:return n=e.sent,e.next=5,n.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){return(M=Object(i.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("prefix: ",t),e.prev=1,e.next=4,fetch(b+"/api/monday/resetPrefix",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({prefix:t})});case 4:return n=e.sent,e.next=7,n.json();case 7:return n=e.sent,e.abrupt("return",n);case 11:e.prev=11,e.t0=e.catch(1);case 13:case"end":return e.stop()}}),e,null,[[1,11]])})))).apply(this,arguments)}var I={query:function(e,t){return w.apply(this,arguments)},updatePrefixMap:function(e){return C.apply(this,arguments)},updatePrefixMapAll:function(e){return P.apply(this,arguments)},getPrefixMapByBoardId:function(e){return k.apply(this,arguments)},addColumnBack:function(e){return j.apply(this,arguments)},authMonday:function(){return g.apply(this,arguments)},getPrefixMapAll:function(e){return O.apply(this,arguments)},resetPrefix:function(e){return M.apply(this,arguments)}},S=n(7),E=n(10),A=n(4),T=n.n(A);var N=function(e){var t=e.columns,n=e.createColumn,o=Object(r.useState)(""),c=Object(S.a)(o,2),s=(c[0],c[1],Object(r.useState)(null)),u=Object(S.a)(s,2),i=u[0],p=u[1],l=t.map((function(e){return{value:e.id,label:e.title}}));return a.a.createElement("form",{className:"add-column"},a.a.createElement(E.a,{placeholder:"Choose a Status column as an ID prefix",value:i,options:l,onChange:function(e){p(e)},className:"check"}),a.a.createElement(T.a,{kind:T.a.kinds.PRIMARY,onClick:function(e){e.preventDefault(),(null===i||void 0===i?void 0:i.value)&&n(i.value)},style:{width:"150px"},size:T.a.sizes.MEDIUM},"Add Column"))};function B(e){var t=e.prefixKeys,n=e.resetPrefix,o=Object(r.useState)(null),c=Object(S.a)(o,2),s=c[0],u=c[1];return a.a.createElement("form",{className:"reset-prefix"},a.a.createElement(E.a,{placeholder:"Choose prefix to reset",value:s,options:t,onChange:function(e){console.log("handleSelect -> selectedOption",e),u(e)},className:"check"}),a.a.createElement(T.a,{onClick:function(){s.value&&n(s.value)},color:T.a.colors.NEGATIVE,kind:T.a.kinds.PRIMARY,style:{width:"150px"},size:T.a.sizes.MEDIUM},"Reset Prefix"))}var _=v()(),D=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(p.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={settings:{background:"#e2445c",attentionBoxTitle:"Hey",attentionBoxType:"danger"},name:"",nextNum:null,columns:null,selectedColumn:null,prefixMap:null,isFirst:!0,prefixKeys:null},e.getItemsIds=function(){var e=Object(i.a)(u.a.mark((function e(t){var n,r,a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="\n    query \n      { boards (ids:".concat(t,") \n        { items {\n           id\n      \n          }\n        }\n      }"),e.next=3,_.api(n);case 3:return r=e.sent,a=r.data,o=a.boards[0].items,e.abrupt("return",o.map((function(e){return e.id})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.createColumn=function(){var t=Object(i.a)(u.a.mark((function t(n){var r,a,o,c,s,p,l,f,d;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,h.a.showLoading(),r=e.state.boardId,t.next=5,I.getPrefixMapByBoardId(r);case 5:return a=t.sent,t.next=8,I.getPrefixMapAll(r);case 8:if(o={map:(o=t.sent)[0]},!a){t.next=17;break}return t.next=13,h.a.fire({title:"You Already have an ID Column",text:"Are you sure you want to create another one?",icon:"warning",confirmButtonText:"yes",showDenyButton:"true",denyButtonText:"no"});case 13:if(c=t.sent,c.isConfirmed){t.next=17;break}return t.abrupt("return");case 17:return s="mutation {\n        create_column(board_id: ".concat(r,', title: "PERSISTENT ID", column_type: text) {\n          id\n        }\n      }'),t.next=20,_.api(s);case 20:return p=t.sent,l=p.data.create_column.id,t.next=24,e.getColPrefixs(n,r);case 24:return f=t.sent,t.next=27,e.getItemsIds(r);case 27:return d=t.sent,a=a||{map:{},boardId:r},d.forEach(function(){var t=Object(i.a)(u.a.mark((function t(n,a){var c,i,p;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=f[a],i="",!c){t.next=7;break}return t.next=5,e.getPrefixCount(c,o);case 5:p=t.sent,i=c+"-"+p;case 7:return i=JSON.stringify(i),s=" mutation {\n          change_simple_column_value (board_id: ".concat(r,", item_id: ").concat(n,', column_id: "').concat(l,'", value: ').concat(i,") {\n            id\n          }\n        }"),t.next=11,_.api(s);case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),t.next=32,e.savePrefixMap(a,o,n,l);case 32:h.a.close(),h.a.fire({icon:"success",title:"Column Added Successfully",text:"Please refresh to continue"}),t.next=39;break;case 36:t.prev=36,t.t0=t.catch(0),console.log("error: ",t.t0);case 39:return t.prev=39,t.finish(39);case 41:case"end":return t.stop()}}),t,null,[[0,36,39,41]])})));return function(e){return t.apply(this,arguments)}}(),e.getColPrefixs=function(){var e=Object(i.a)(u.a.mark((function e(t,n){var r,a,o,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="query\n                     {  boards (ids:".concat(n,") \n                         { items {\n                           column_values {\n                             id\n                             text\n                            }\n                         }\n                       }\n                     }"),e.next=3,_.api(r);case 3:return a=e.sent,o=a.data.boards,c=o[0].items,e.abrupt("return",c.map((function(e){return e.column_values.find((function(e){return e.id===t})).text})));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.getPrefixCount=function(){var e=Object(i.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("null"!==t){e.next=2;break}return e.abrupt("return","");case 2:return n.map[t]=n.map[t]?n.map[t]+1:1,e.abrupt("return",n.map[t]);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.savePrefixMap=function(){var e=Object(i.a)(u.a.mark((function e(t,n,r,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.targetColId=a,t.srcColId=r,e.next=4,I.updatePrefixMap(t);case 4:return e.sent,e.next=7,I.updatePrefixMapAll(n);case 7:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),e.setSelectedColumn=function(t){e.setState({selectedColumn:t})},e.authMonday=function(){I.authMonday()},e.setPrefixKeys=Object(i.a)(u.a.mark((function t(){var n,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I.getPrefixMapAll();case 2:n=t.sent,r=Object.keys(n[0]).filter((function(e){return"_id"!==e})).map((function(e){return{value:e,label:e}})),e.setState({prefixKeys:r}),console.log("setPrefixKeys= -> prefixKeys",r);case 6:case"end":return t.stop()}}),t)}))),e.resetPrefix=function(){var e=Object(i.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.fire({title:"",text:'Are you sure you want to reset "'.concat(t,'"?'),icon:"warning",confirmButtonText:"yes",showDenyButton:"true",denyButtonText:"no"});case 2:if(n=e.sent,n.isConfirmed){e.next=6;break}return e.abrupt("return");case 6:return e.prev=6,e.next=9,I.resetPrefix(t);case 9:h.a.fire({icon:"success",title:'The prefix "'.concat(t,'" is now reset')}),e.next=14;break;case 12:e.prev=12,e.t0=e.catch(6);case 14:case"end":return e.stop()}}),e,null,[[6,12]])})));return function(t){return e.apply(this,arguments)}}(),e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=Object(i.a)(u.a.mark((function e(){var t,n=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setPrefixKeys(),e.next=3,_.listen("context",function(){var e=Object(i.a)(u.a.mark((function e(r){var a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.data.boardIds[0],n.setState(Object(m.a)(Object(m.a)({},n.state),{},{boardId:a})),t="query {boards (ids:".concat(n.state.boardId,"){\n        columns {\n          id\n          title\n          type\n        }\n      }}"),e.next=5,_.api(t);case 5:r=e.sent,o=(o=r.data.boards[0].columns).filter((function(e){return"color"===e.type||"text"===e.type})),console.log("Home -> awaitmonday.listen -> columns",o),n.setState({columns:o});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.columns,n=e.prefixKeys;return t?a.a.createElement("div",{className:"container"},a.a.createElement(N,{setSelectedColumn:this.setSelectedColumn,columns:t,createColumn:this.createColumn}),n&&a.a.createElement(B,{resetPrefix:this.resetPrefix,prefixKeys:n})):a.a.createElement("div",null,"Loading..")}}]),n}(a.a.Component),J=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(p.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=Object(i.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return a.a.createElement("div",{className:"main-container"},a.a.createElement(D,null))}}]),n}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(J,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},20:function(e,t,n){},42:function(e,t,n){e.exports=n(113)},47:function(e,t,n){}},[[42,1,2]]]);
//# sourceMappingURL=main.07bf986b.chunk.js.map